import numpy as np
#
# #4x4
# x = np.array(
#     [[1, 2, 3, 4],
#      [5, 6, 7, 8],
#      [9, 10, 11, 12],
#      [13, 14, 15, 16]]
# )
#
# # stride=1
# x_col = np.array([[1, 2, 3, 5, 6, 7, 9, 10, 11],
#                   [2, 3, 4, 6, 7, 8, 10, 11, 12],
#                   [5, 6, 7, 9, 10, 11, 13, 14, 15],
#                   [6, 7, 8, 10, 11, 12, 14, 15, 16]])
# #3x3
# w = np.array([[1, 2, 3],
#               [4, 5, 6],
#               [7, 8, 9]])
#
# w_col = np.array([[1],
#                   [2],
#                   [3],
#                   [4],
#                   [5],
#                   [6],
#                   [7],
#                   [8],
#                   [9]])
# #2x2
# out = x_col.dot(w_col).reshape(2, 2)
# print("out\n", out)
#
# dy = np.array([[1, 2],
#                [3, 4]])
#
#
# dy_pad = np.array([
#     [0, 0, 0, 0, 0, 0],
#     [0, 0, 0, 0, 0, 0],
#     [0, 0, 1, 2, 0, 0],
#     [0, 0, 3, 4, 0, 0],
#     [0, 0, 0, 0, 0, 0],
#     [0, 0, 0, 0, 0, 0]
# ])
#
# dy_pad_col = np.array([[0, 0, 0, 0, 0, 0, 0, 0, 1],
#                        [0, 0, 0, 0, 0, 0, 0, 1, 2],
#                        [0, 0, 0, 0, 0, 0, 1, 2, 0],
#                        [0, 0, 0, 0, 0, 0, 2, 0, 0],
#
#                        [0, 0, 0, 0, 0, 1, 0, 0, 3],
#                        [0, 0, 0, 0, 1, 2, 0, 3, 4],
#                        [0, 0, 0, 1, 2, 0, 3, 4, 0],
#                        [0, 0, 0, 2, 0, 0, 4, 0, 0],
#
#                        [0, 0, 1, 0, 0, 3, 0, 0, 0],
#                        [0, 1, 2, 0, 3, 4, 0, 0, 0],
#                        [1, 2, 0, 3, 4, 0, 0, 0, 0],
#                        [2, 0, 0, 4, 0, 0, 0, 0, 0],
#
#                        [0, 0, 3, 0, 0, 0, 0, 0, 0],
#                        [0, 3, 4, 0, 0, 0, 0, 0, 0],
#                        [3, 4, 0, 0, 0, 0, 0, 0, 0],
#                        [4, 0, 0, 0, 0, 0, 0, 0, 0]])
#
# rot_w_col = np.array([[9],
#                       [8],
#                       [7],
#                       [6],
#                       [5],
#                       [4],
#                       [3],
#                       [2],
#                       [1]])
#
# dx = dy_pad_col.dot(rot_w_col).reshape(4,4)
# print("dx\n",dx)

# # stride=1
# x_col = np.array(
#     [
#         [1, 2, 5, 6],
#         [2, 3, 6, 7],
#         [3, 4, 7, 8],
#         [5, 6, 9, 10],
#         [6, 7, 10, 11],
#         [7, 8, 11, 12],
#         [9, 10, 13, 14],
#         [10, 11, 14, 15],
#         [11, 12, 15, 16]
#     ])
#
# w = np.array([[1, 2],
#               [3, 4]])
#
# w_col = np.array([[1],
#                   [2],
#                   [3],
#                   [4]])
#
# out = x_col.dot(w_col)
# print("out\n", out.reshape(3, 3))
#
# dy = np.array([[1, 2, 3],
#                [4, 5, 6],
#                [7, 8, 9]])
#
# dy_pad = np.array([[0, 0, 0, 0, 0],
#                    [0, 1, 2, 3, 0],
#                    [0, 4, 5, 6, 0],
#                    [0, 7, 8, 9, 0],
#                    [0, 0, 0, 0, 0]])
#
# dy_pad_col = np.array([
#     [0,0,0,1],
#     [0,0,1,2],
#     [0,0,2,3],
#     [0,0,3,0],
#     [0,1,0,4],
#     [1,2,4,5],
#     [2,3,5,6],
#     [3,0,6,0],
#     [0,4,0,7],
#     [4,5,7,8],
#     [5,6,8,9],
#     [6,0,9,0],
#     [0,7,0,0],
#     [7,8,0,0],
#     [8,9,0,0],
#     [9,0,0,0]
# ])
#
# rot_w_col = np.array([[4],
#                       [3],
#                       [2],
#                       [1]])
#
# dx = dy_pad_col.dot(rot_w_col).reshape(4,4)
# print("dx\n", dx)


data = np.random.rand(2,3,4,5)
a = 0
for i in range(2):
    for j in range(3):
        for m in range(4):
            for n in range(5):
                data[i,j,m,n] = a
                a+=1



print("data:\n",data)
re = data.transpose(0,2,3,1)
print("re:\n", re)

res = re.reshape(-1, 3)

print("res:\n", res)